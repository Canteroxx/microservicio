<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>BNE - Buscar Empleos</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .filtros { background: #f7f7f7; padding: 15px; border-radius: 6px; margin-bottom: 20px; }
    .filtros select, .filtros input { margin: 5px; padding: 6px; }
    .ofertas { margin-top: 20px; }
    .oferta { border: 1px solid #ddd; padding: 10px; margin-bottom: 10px; border-radius: 4px; }
  </style>
</head>
<body>
  <h1>Ofertas de Empleo</h1>

  <div class="filtros">
    <input type="text" id="busqueda" placeholder="Profesi√≥n, empresa o palabra clave">
    <select id="estado">
      <option value="">Estado</option>
      <option value="ABIERTA">ABIERTA</option>
      <option value="CERRADA">CERRADA</option>
    </select>
    <button onclick="buscar()">üîç Buscar</button>
  </div>

  <div class="ofertas" id="resultados"></div>

  <script>
    async function buscar() {
      const resp = await fetch("/api/ofertas");
      const data = await resp.json();
      const filtroTexto = document.getElementById("busqueda").value.toLowerCase();
      const filtroEstado = document.getElementById("estado").value;
      const div = document.getElementById("resultados");
      div.innerHTML = "";

      data
        .filter(o => 
          (!filtroTexto || o.titulo.toLowerCase().includes(filtroTexto) || o.empresa.toLowerCase().includes(filtroTexto)) &&
          (!filtroEstado || o.estado === filtroEstado)
        )
        .forEach(o => {
          const card = document.createElement("div");
          card.className = "oferta";
          card.innerHTML = `<strong>${o.titulo}</strong> - ${o.empresa}<br>${o.descripcion}<br><em>Estado: ${o.estado}</em>`;
          div.appendChild(card);
        });
    }

    // cargar al inicio
    buscar();
  </script>
</body>
</html>
